q()
setwd("C:\\Users\\admin\\Documents\\Github\\Projekt_2_PDU")
Df <- read.csv("Dane/2006.csv")
Aircrafts <- read.csv("Dane/plane-data.csv")
Df_selected <- Df %>%
select(TailNum,ArrDelay)
library(dplyr)
library(ggplot2)
Df_selected <- Df %>%
select(TailNum,ArrDelay)
Aircrafts_selected <- Aircrafts %>%
select(tailnum, manufacturer, model)
result <- merge(Df_selected, Aircrafts_selected, by.x = "TailNum", by.y = "tailnum")
result_model <- result %>%
filter(model != "") %>%
group_by(manufacturer, model) %>%
summarize(MeanArrDelay = mean(ArrDelay, na.rm = T), count = n()) %>%
filter(count > 150000) %>% # dla 2007 i 2006 (150k) dla 2000 (75k) i dla 1995 (60k)
arrange(desc(MeanArrDelay))
ggplot(result_model, aes(x=reorder(model, -MeanArrDelay), y=MeanArrDelay, fill=manufacturer)) +
geom_bar(stat="identity") +
scale_fill_brewer(palette = "Set1") +
coord_flip() +
theme_minimal() +
labs(x="Model", y="Średnie opóżnienie przylotu w minutach", title="Średnie opóźnienie przylotu dla najczęstszych modeli samolotów dla lotów z roku 2006 ", fill="Producent") +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
setwd("C:\\Users\\admin\\Documents\\Github\\Projekt_2_PDU")
Df <- read.csv("Dane/2007.csv")
Aircrafts <- read.csv("Dane/plane-data.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
View(result)
# result <- result[-c(3, (nrow(result))),]
result <- result[c(2:45),]
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2004",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2007",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
Df <- read.csv("Dane/2006.csv")
Aircrafts <- read.csv("Dane/plane-data.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2007",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
Df <- read.csv("Dane/2004.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2007",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
# result <- result[-c(3, (nrow(result))),]
result <- result[c(3:43),]
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2007",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
l
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2004",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
Df <- read.csv("Dane/2003.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
# result <- result[-c(3, (nrow(result))),]
result <- result[c(3:42),]
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2004",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2003",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
Df <- read.csv("Dane/2000.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
View(result)
# result <- result[-c(3, (nrow(result))),]
result <- result[c(4:40),]
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2003",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2000",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
Df <- read.csv("Dane/1995.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
# result <- result[-c(3, (nrow(result))),]
result <- result[c(7:38),]
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2000",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
Df <- read.csv("Dane/2004.csv")
diff <- Df %>%
filter(DepDelay > 0) %>%
mutate(DiffDelay = DepDelay - ArrDelay) %>%
select(TailNum, DiffDelay)
diff_with_models <- merge(diff, Aircrafts, by.x = "TailNum", by.y = "tailnum")
result <- diff_with_models %>%
filter(type == "Corporation") %>%
group_by(year) %>%
summarize(AvgCatchUp = mean(DiffDelay, na.rm = TRUE), count = n()) %>%
arrange(desc(year))
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_size(labels = scales::comma) + # dla 2004
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 15)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 30)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 10)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = scales::label_comma()) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = scales::label_number(big.mark = ",", scientific = FALSE)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = function(x) format(x, big.mark = ",", scientific = FALSE, trim = TRUE)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), trans = 'log10') +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20)) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = comma) +
scale_color_gradient(low="blue", high="red") +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = comma) +
scale_color_gradient(low="blue", high="red", labels = comma) +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = scales::comma) +
scale_color_gradient(low="blue", high="red", labels = scales::comma) +
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 1995",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = scales::comma) +
scale_color_gradient(low="blue", high="red", labels = scales::comma) + # dodane labels dla 2004
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2004",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
# result <- result[-c(3, (nrow(result))),]
result <- result[c(3:43),]
ggplot(result, aes(x=year, y=AvgCatchUp, size=count, color=count)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype="dashed", color = "red") +
theme_minimal() +
scale_size_continuous(range = c(1, 20), labels = scales::comma) +
scale_color_gradient(low="blue", high="red", labels = scales::comma) + # dodane labels dla 2004
guides(color = guide_legend(), size = guide_legend()) +
labs(title = "Średni czas nadgonienia opóźnienia w zależności od roku produkcji samolotu dla lotów w roku 2004",
x = "Rok Produkcji",
y = "Średni czas nadgonienia (w minutach)",
color = "Ilość samolotów dla danego roku produkcji",
size = "Ilość samolotów dla danego roku produkcji")
