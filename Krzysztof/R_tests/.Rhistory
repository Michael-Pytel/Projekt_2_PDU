cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, executable(get(df_name),...))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), View, 5)
execute_function_on_frame <- function(data_directory,names_frames, executable, ...){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, executable(get(df_name),...))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), View, 5)
?View
?head
execute_function_on_frame(dest, c("airports"), head, n = 5)
execute_function_on_frame <- function(data_directory,names_frames, executable, ...){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, executable(get(df_name),...))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), head, n = 5)
data_directory <- dest
names_frames <- file_names
files <- file.path(data_directory, names_frames)
files
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
i <- 1
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
files[i]
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
executable <- head
#execute function
assign(df_name, executable(get(df_name)))
View(df_airports)
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
head(df_airports)
... <- n = 5
#execute function
assign(df_name, executable(get(df_name),5))
execute_function_on_frame <- function(data_directory, names_frames, executable, ...){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, executable(get(df_name),...))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), head, n = 5)
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), head, n = 10)
execute_function_on_frame(dest, c("airports"), head)
execute_function_on_frame(dest, c("airports"), tail)
execute_function_on_frame(dest, c("airports"), colnames)
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), colnames)
rm(list = ls())
massDownload <- function(urls,
outdir,
quiet = FALSE,
file_names = NULL,
ext ='.csv.bz2'){
#this function was written during PDU class
#returns logical vector showing which files were successfully downloaded
options(timeout = 300)
info <- logical(length(urls))
names(info) <- urls
if(!dir.exists(outdir)){
warning("NOWY katalog zostal stworzony!")
dir.create(outdir, recursive = TRUE)
}
if(is.null(file_names) || length(file_names) != length(urls) ){
file_names <-  1:length(urls)
}
outputs <- file.path(outdir, paste(file_names, ext, sep = ''))
for( i in 1:length(urls)){
tryCatch(
expr = {
download.file(urls[i], outputs[i], quiet = quiet)
TRUE
},
error = function(e) {
FALSE
}
) -> info[i]
}
invisible(info)
}
#FINAL VERSION 1.1
###########################################
#
library('data.table')
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), colnames)
dest <- "~/laby_PDU/Projekt_2_outer/Projekt_2_PDU/Dane"
file_names <- c("airports")
execute_function_on_frame(dest, c("airports"), colnames)
execute_function_on_frame(dest, c("airports"), colnames)
execute_function_on_frame(dest, c("airports"), head)
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), FUN = function(x){head(x,10)})
###Params
num_of_flights_daily <- function(dataFrame){
#Uses data.table package
#returns a data.table with grouped rows by month and day values
result <- as.data.table(dataFrame)[,.("Count" = .N),
keyby = .(Month, DayofMonth)]
}
execute_function_on_frame(dest, c("airports"), FUN = function(x){"elo"})
#FINAL VERSION 1.1
###########################################
#
library('data.table')
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
}
}
execute_function_on_frame(dest, c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
}
}
execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name)
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
}
}
execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name)
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
}
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
}
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name,'\n'))
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
}
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name),,'\n')
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
}
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name),'\n')
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
}
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name),'\n')
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
} ->result
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
result
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name),'\n')
#execute function
assign(df_name, FUN(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
} ->result
result
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){"elo"})
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){head(x,5)})
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){head(x,5)})
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){return(head(x,5))})
##############################
execute_function_on_frame <- function(data_directory, names_frames, FUN){
files <- file.path(data_directory, names_frames)
for(i in 1:length(names_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
cat(df_name,'\n')
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
cat(class(df_name),'\n')
#execute function
assign(df_name, FUN(get(df_name)))
cat(class(df_name),'\n')
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
#gc() # free unused memory
#cat('Cleaning complete\n')
df_name
} ->result
result
}
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){return(head(x,5))})
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){return(x))})
result <- execute_function_on_frame(data_directory = dest, names_frames =  c("airports"), FUN = function(x){return(x)})
files <- file.path(data_directory, names_frames)
data_directory <- "~/laby_PDU/Projekt_2_outer/Projekt_2_PDU/Dane"
urls_frames <- c("https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/HG7NV7/YGU3TD",
"https://dataverse.harvard.edu/api/access/datafile/:persistentId?persistentId=doi:10.7910/DVN/HG7NV7/CI5CEM")
names_frames <- c("2000", "2001")
files <- file.path(data_directory, names_frames)
for(i in 1:length(urls_frames)){
cat(paste("i = ", i,"\n", sep = ""))
#  #download
#  massDownload(urls_frames[i],
#                 outdir = data_directory,
#                 file_names = names_frames[i])
#  cat("Download complete\n")
#
#  #extract
#  massUnpack_bzip2(files[i])
#  cat('Extract complete\n')
#create variable
df_name <- paste("df_", names_frames[i], sep = "")
assign(df_name, read.csv(paste(files[i], ".csv", sep="")))
#execute function
assign(df_name, num_of_flights_daily(get(df_name)))
cat('Analysis complete\n')
#  #delete file
#  system2("rm", args = paste(files[i], ".csv", sep=""))
#clean memory
gc() # free unused memory
cat('Cleaning complete\n')
}
